{"name":"Fit Tile to Scene","type":"script","author":"xjKGzWFbtOifTl9H","img":"icons/skills/targeting/crosshair-bars-yellow.webp","scope":"global","command":"renderDialog();\n\nfunction renderDialog(){\n    //filter out things that aren't tiles\n    let viewedScene = game.scenes.viewed;\n    let sceneTiles = canvas.background.controlled.filter((obj)=> obj.document.documentName === 'Tile');\n    if(sceneTiles.length === 0){\n        ui.notifications.warn(\"No tiles selected\");\n        return;\n    }\n    let d = new Dialog({\n  title: 'Fit Tile to Scene',\n  content: `Along which dimension should the tile fit?`,\n  buttons: {\n    width: {\n      label: 'Width',\n      callback: ()=>{fitTo('width')}\n    },\n\n    height: {\n        label: 'Height',\n        callback: ()=>{fitTo('height')}\n    },   \n    both: {\n        label: 'Both',\n        callback: ()=>{fitTo('both')}\n    },\n  }\n}).render(true);\n}\n\nfunction fitTo(whichDimension){\n        //filter out things that aren't tiles\n        let viewedScene = game.scenes.viewed;\n\n    let sceneTiles = canvas.background.controlled.filter((obj)=> obj.document.documentName === 'Tile');\n    let dimensions = viewedScene.dimensions;\n\n    //get array of tile ids for update\n    let tileData = sceneTiles.map((tile) => {return{_id: tile.data._id}})\n    let updateData = {}\n    \n    switch (whichDimension) {\n        case 'width':\n            // code\n            updateData.width = dimensions.sceneWidth;\n            break;\n         case 'height':\n             updateData.height = dimensions.sceneHeight;\n             break;\n        case 'both':\n             updateData.width = dimensions.sceneWidth;\n             updateData.height = dimensions.sceneHeight;\n            break;\n    }\n    tileData = tileData.map((data)=> {return {...data, ...updateData}})\n    updateTiles(tileData)\n}\n\nfunction updateTiles(updateData){\n    let viewedScene = game.scenes.viewed;\n\n    viewedScene.updateEmbeddedDocuments(\"Tile\", updateData);\n}","folder":null,"sort":0,"permission":{"default":0,"xjKGzWFbtOifTl9H":3},"flags":{"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.KWmUj6RKO4bzYdk8"}},"_id":"MLL69yfurMWrt6Sc"}
